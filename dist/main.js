/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/script.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n;// CONCATENATED MODULE: ./src/style.css\n// extracted by mini-css-extract-plugin\n\n;// CONCATENATED MODULE: ./src/works/api.worker.js\nfunction Worker_fn() {\n  return new Worker(__webpack_require__.p + "api.worker.worker.js");\n}\n\n;// CONCATENATED MODULE: ./src/works/conversao.worker.js\nfunction conversao_worker_Worker_fn() {\n  return new Worker(__webpack_require__.p + "conversao.worker.worker.js");\n}\n\n;// CONCATENATED MODULE: ./src/script.js\n\r\nconst graphicContainerElement = document.querySelector(".graphic-container");\r\nconst containerElement = document.querySelector(".container");\r\nconst loaderElement = document.querySelector(".loader");\r\nconst graphicElement = document.getElementById("graphic");\r\nconst dateElement = document.querySelector(".date");\r\nconst exchangeRateElement = document.querySelector(".exchange-rate");\r\nconst exchangeCurrencyElement = document.querySelector(".exchange-currency");\r\nconst select1Element = document.querySelector(".select-1");\r\nconst select2Element = document.querySelector(".select-2");\r\nconst inputField1 = document.querySelector(\r\n  ".input-container:nth-child(1) .input-field"\r\n);\r\nconst inputField2 = document.querySelector(\r\n  ".input-container:nth-child(2) .input-field"\r\n);\r\nlet select1Value = select1Element.value;\r\nlet select2Value = select2Element.value;\r\n\r\n\r\n\r\nlet PARAMS = `${select1Element.value}-${select2Element.value}`;\r\n\r\nconst graphicChart = new Chart(graphicElement, {\r\n  type: "line",\r\n  data: {\r\n    labels: [],\r\n    datasets: [\r\n      {\r\n        label: "",\r\n        data: [],\r\n      },\r\n    ],\r\n  },\r\n  options: {\r\n    scales: {\r\n      y: {\r\n        ticks: {\r\n          maxTicksLimit: 5,\r\n        },\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nfunction preRender() {\r\n  graphicContainerElement.setAttribute("class", "graphic-container");\r\n  containerElement.setAttribute("class", "container");\r\n  loaderElement.setAttribute("class", "none");\r\n}\r\n\r\nfunction handleExchangeCurrency(name, rate) {\r\n  const [currentName] = name?.split("/");\r\n  exchangeCurrencyElement.textContent = `${rate} ${currentName} igual a`;\r\n  window.localStorage.setItem(\r\n    "ExchangeCurrency",\r\n    JSON.stringify({ name: "Dólar Americano/", rate: 1 })\r\n  );\r\n}\r\n\r\nfunction handleExchangeRate(name, rate) {\r\n  const [, currentName] = name?.split("/");\r\n  const newRate = Number(rate).toFixed(2).toString().replace(".", ",");\r\n  exchangeRateElement.textContent = `${newRate} ${currentName}`;\r\n\r\n  window.localStorage.setItem(\r\n    "ExchangeRate",\r\n    JSON.stringify({ name: "/Real Brasileiro", rate })\r\n  );\r\n}\r\n\r\nfunction handleDate(date) {\r\n  dateElement.textContent = date;\r\n  window.localStorage.setItem("Date", date);\r\n}\r\n\r\nfunction handleGraphicChart(currencyQuote) {\r\n  const [currentName] = currencyQuote?.name?.split("/");\r\n  graphicChart.data.labels.push(currencyQuote?.hoursAndSeconds);\r\n  graphicChart.data.datasets.forEach((currentDataset) => {\r\n    currentDataset.label = currentName;\r\n    currentDataset.data.push(currencyQuote?.ask);\r\n\r\n    if (currencyQuote.data && currencyQuote.data.length >= 5) {\r\n      currentDataset.data.shift();\r\n    }\r\n  });\r\n\r\n  if (graphicChart?.data?.labels.length >= 7) {\r\n    graphicChart?.data?.labels.shift();\r\n    graphicChart?.data?.labels.shift();\r\n  }\r\n\r\n  graphicChart.update();\r\n}\r\n\r\nfunction resetGraphic() {\r\n  graphicChart.data = {\r\n    labels: [],\r\n    datasets: [\r\n      {\r\n        label: "",\r\n        data: [],\r\n        borderWidth: 1,\r\n      },\r\n    ],\r\n  };\r\n}\r\n\r\nfunction script_reset() {\r\n  resetGraphic();\r\n  workApi = new Worker_fn();\r\n  workApi.postMessage(PARAMS);\r\n  render();\r\n}\r\n\r\nlet workApi = new Worker_fn();\r\n\r\nworkApi.postMessage(PARAMS);\r\nrender();\r\n\r\nfunction render() {\r\n  workApi.addEventListener("message", (e) => {\r\n    const currencyQuote = e.data;\r\n    window.localStorage.setItem("Ask", currencyQuote.ask);\r\n    handleDate(currencyQuote.date);\r\n    handleExchangeCurrency(currencyQuote.name, 1);\r\n    handleExchangeRate(currencyQuote.name, currencyQuote.ask);\r\n    handleGraphicChart(currencyQuote);\r\n  });\r\n}\r\n\r\nlet workerConversor = new conversao_worker_Worker_fn();\r\nworkerConversor.postMessage(PARAMS);\r\n\r\nworkerConversor.addEventListener("message", (event) => {\r\n  preRender();\r\n  const quote = event.data;\r\n  const askStorage = window.localStorage.getItem("Ask");\r\n  inputField1.addEventListener("input", (e) => {\r\n    const value = e.target.value;\r\n    if (askStorage && !isNaN(value)) {\r\n      inputField2.value = (Number(value) * Number(askStorage)).toFixed(2);\r\n    }\r\n    if (!isNaN(value)) {\r\n      inputField2.value =\r\n        value === "" ? "" : (Number(value) * quote).toFixed(2);\r\n    }\r\n  });\r\n  inputField2.addEventListener("input", (e) => {\r\n    const value = e.target.value;\r\n    if (askStorage && !isNaN(value)) {\r\n      inputField1.value = (Number(value) * Number(askStorage)).toFixed(2);\r\n    }\r\n\r\n    if (!isNaN(value)) {\r\n      inputField1.value =\r\n        value === "" ? "" : (Number(value) * quote).toFixed(2);\r\n    }\r\n  });\r\n});\r\n\r\nfunction resetAsk() {\r\n  workerConversor = new conversao_worker_Worker_fn();\r\n  workerConversor.postMessage(PARAMS);\r\n  workerConversor.addEventListener("message", (event) => {\r\n    const quote = event.data;\r\n    const askStorage = window.localStorage.getItem("Ask");\r\n    inputField1.addEventListener("input", (e) => {\r\n      const value = e.target.value;\r\n      if (askStorage && !isNaN(value)) {\r\n        inputField2.value = (Number(value) * Number(askStorage)).toFixed(2);\r\n      }\r\n      if (!isNaN(value)) {\r\n        inputField2.value =\r\n          value === "" ? "" : (Number(value) * quote).toFixed(2);\r\n      }\r\n    });\r\n    inputField2.addEventListener("input", (e) => {\r\n      const value = e.target.value;\r\n      if (askStorage && !isNaN(value)) {\r\n        inputField1.value = (Number(value) * Number(askStorage)).toFixed(2);\r\n      }\r\n\r\n      if (!isNaN(value)) {\r\n        inputField1.value =\r\n          value === "" ? "" : (Number(value) * quote).toFixed(2);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n// CSS\r\nselect1Element.addEventListener("focus", () => {\r\n  inputField1.classList.add("focused");\r\n});\r\n\r\nselect1Element.addEventListener("blur", () => {\r\n  inputField1.classList.remove("focused");\r\n});\r\n\r\nselect2Element.addEventListener("focus", () => {\r\n  inputField2.classList.add("focused");\r\n});\r\n\r\nselect2Element.addEventListener("blur", () => {\r\n  inputField2.classList.remove("focused");\r\n});\r\n\r\n// select interação\r\nselect1Element.addEventListener("change", (e) => {\r\n  workApi.terminate();\r\n  workerConversor.terminate();\r\n  PARAMS = `${e.target.value}-${select2Value}`;\r\n  select1Value = e.target.value;\r\n  resetAsk();\r\n  script_reset();\r\n});\r\n\r\nselect2Element.addEventListener("change", (e) => {\r\n  workApi.terminate();\r\n  workerConversor.terminate();\r\n  PARAMS = `${select1Value}-${e.target.value}`;\r\n  select2Value = e.target.value;\r\n  resetAsk();\r\n  script_reset();\r\n});\r\n\n\n//# sourceURL=webpack://currency-quote-realtime/./src/script.js_+_3_modules?')}},__webpack_require__={};__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var r=__webpack_require__.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var n=r.getElementsByTagName("script");if(n.length)for(var t=n.length-1;t>-1&&!e;)e=n[t--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})();var __webpack_exports__={};__webpack_modules__["./src/script.js"](0,__webpack_exports__,__webpack_require__)})();